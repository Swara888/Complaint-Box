{"ast":null,"code":"import{useEffect,useState}from\"react\";import{Box,Typography,Button,CircularProgress}from\"@mui/material\";import ComplaintCard from\"../components/ComplaintCard\";import API from\"../api/axios\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ComplaintsList(){const[complaints,setComplaints]=useState([]);const[loading,setLoading]=useState(false);// loading state\nconst[error,setError]=useState(null);// error state\nconst[updatingId,setUpdatingId]=useState(false);// for disabling button when updating\nconst navigate=useNavigate();// Fetch complaints from backend\nconst fetchComplaints=async()=>{setLoading(true);setError(null);try{const res=await API.get(\"/complaints/\");setComplaints(res.data);}catch(err){console.error(\"Error fetching complaints:\",err);setError(\"Failed to fetch complaints. Check console.\");}finally{setLoading(false);}};useEffect(()=>{fetchComplaints();},[]);// Toggle complaint status (done/pending)\nconst toggleStatus=async id=>{setUpdatingId(true);try{await API.put(\"/complaints/done/\".concat(id,\"/\"));fetchComplaints();// refresh list\n}catch(err){console.error(\"Failed to update status\",err);alert(\"Failed to update status. Check console.\");}finally{setUpdatingId(false);}};return/*#__PURE__*/_jsxs(Box,{p:3,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",fontWeight:600,mb:2,children:\"Complaints\"}),loading&&/*#__PURE__*/_jsx(CircularProgress,{}),error&&/*#__PURE__*/_jsx(Typography,{color:\"error\",children:error}),!loading&&complaints.length===0&&/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",children:\"No complaints found\"}),complaints.map(c=>/*#__PURE__*/_jsx(Box,{mb:2,children:/*#__PURE__*/_jsx(ComplaintCard,{complaint:c,onClick:()=>navigate(\"/complaints/\".concat(c.id))})},c.id))]});}","map":{"version":3,"names":["useEffect","useState","Box","Typography","Button","CircularProgress","ComplaintCard","API","useNavigate","jsx","_jsx","jsxs","_jsxs","ComplaintsList","complaints","setComplaints","loading","setLoading","error","setError","updatingId","setUpdatingId","navigate","fetchComplaints","res","get","data","err","console","toggleStatus","id","put","concat","alert","p","children","variant","fontWeight","mb","color","length","map","c","complaint","onClick"],"sources":["C:/Users/Swarlali/OneDrive/Desktop/Complaint_Box/frontend/src/pages/ComplaintsList.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { Box, Typography, Button, CircularProgress } from \"@mui/material\";\r\nimport ComplaintCard from \"../components/ComplaintCard\";\r\nimport API from \"../api/axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nexport default function ComplaintsList() {\r\n  const [complaints, setComplaints] = useState([]);\r\n  const [loading, setLoading] = useState(false); // loading state\r\n  const [error, setError] = useState(null); // error state\r\n  const [updatingId, setUpdatingId] = useState(false); // for disabling button when updating\r\n\r\n  const navigate = useNavigate();\r\n\r\n  // Fetch complaints from backend\r\n  const fetchComplaints = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const res = await API.get(\"/complaints/\");\r\n      setComplaints(res.data);\r\n    } catch (err) {\r\n      console.error(\"Error fetching complaints:\", err);\r\n      setError(\"Failed to fetch complaints. Check console.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchComplaints();\r\n  }, []);\r\n\r\n  // Toggle complaint status (done/pending)\r\n  const toggleStatus = async (id) => {\r\n    setUpdatingId(true);\r\n    try {\r\n      await API.put(`/complaints/done/${id}/`);\r\n      fetchComplaints(); // refresh list\r\n    } catch (err) {\r\n      console.error(\"Failed to update status\", err);\r\n      alert(\"Failed to update status. Check console.\");\r\n    } finally {\r\n      setUpdatingId(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box p={3}>\r\n      <Typography variant=\"h5\" fontWeight={600} mb={2}>\r\n        Complaints\r\n      </Typography>\r\n\r\n      {loading && <CircularProgress />}\r\n      {error && <Typography color=\"error\">{error}</Typography>}\r\n\r\n      {!loading && complaints.length === 0 && (\r\n        <Typography color=\"text.secondary\">No complaints found</Typography>\r\n      )}\r\n\r\n      {complaints.map((c) => (\r\n        <Box key={c.id} mb={2}>\r\n          <ComplaintCard\r\n            complaint={c}\r\n            onClick={() => navigate(`/complaints/${c.id}`)}\r\n          />\r\n          \r\n        </Box>\r\n      ))}\r\n    </Box>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}